# bkit v1.5.2 Bridge Fix Plan

> **Summary**: v1.5.1 종합 테스트(335 TC)에서 발견된 D2-11, D2-12 FAIL 건의 근본 원인을 수정하는 패치 계획서
>
> **Project**: bkit-claude-code
> **Version**: 1.5.1 → 1.5.2
> **Author**: bkit Team
> **Date**: 2026-02-06
> **Status**: Finalized
> **Previous Test**: bkit-v1.5.1-comprehensive-test (333/335 PASS, 99.4%)

---

## 1. Overview

### 1.1 Purpose

bkit v1.5.1 종합 테스트에서 발견된 2개 실패 TC(D2-11, D2-12)의 근본 원인을 수정합니다.

### 1.2 Problem Statement

v1.5.1에서 `lib/pdca/automation.js`에 2개 새 함수를 추가했으나, re-export 체인의 **2개 중간 모듈** 모두에서 누락:

```
lib/pdca/automation.js (11 exports)  ← 정상 (2개 포함)
        ↓
lib/pdca/index.js (9 exports)        ← 누락 (2개 미포함)
        ↓
lib/common.js (9 exports)            ← 누락 (index.js에서 이미 누락)
```

### 1.3 Root Cause

| File | Expected | Actual | Gap |
|------|:--------:|:------:|:---:|
| lib/pdca/automation.js | 11 exports | 11 exports | 0 |
| lib/pdca/index.js | 50 exports (48+2) | 48 exports | **-2** |
| lib/common.js | 138 exports (136+2) | 136 exports | **-2** |

누락된 함수:
1. `detectPdcaFromTaskSubject()` - TaskCompleted에서 PDCA phase 감지
2. `getNextPdcaActionAfterCompletion()` - phase 완료 후 다음 액션 결정

### 1.4 Impact Assessment

- **런타임 영향**: 없음 (`scripts/pdca-task-completed.js`가 자체 패턴 매칭 구현)
- **API 완전성**: common.js bridge의 export 수가 설계값(138)과 불일치(136)
- **테스트 결과**: D2-11, D2-12 FAIL → PASS로 전환 기대

---

## 2. Scope

### 2.1 In Scope

- [ ] `lib/pdca/index.js` - 2개 함수 re-export 추가
- [ ] `lib/common.js` - Automation 섹션 export 수 주석 업데이트 (9→11)
- [ ] `lib/common.js` - @version 헤더 업데이트 (1.5.1→1.5.2)
- [ ] `lib/pdca/index.js` - @version 헤더 업데이트 (1.4.7→1.5.2)
- [ ] `lib/pdca/index.js` - Automation 주석 업데이트 (9→11)

### 2.2 Out of Scope

- bkit.config.json 버전 업데이트 (패치 수준, 불필요)
- plugin.json 버전 업데이트 (패치 수준, 불필요)
- 기타 코드 변경

---

## 3. Success Criteria

- [ ] D2-11: `require('../lib/common.js').detectPdcaFromTaskSubject` !== undefined
- [ ] D2-12: `require('../lib/common.js').getNextPdcaActionAfterCompletion` !== undefined
- [ ] lib/pdca/index.js export 수: 50 (48+2)
- [ ] lib/common.js total export 수: 138 (136+2)
- [ ] 기존 335 TC 중 나머지 333 TC 회귀 없음

---

## Version History

| Version | Date | Changes | Author |
|---------|------|---------|--------|
| 1.0 | 2026-02-06 | Initial plan - bridge re-export fix | bkit Team |

---

*Generated by bkit PDCA Skill | 2026-02-06*
